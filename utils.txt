functin for version 2